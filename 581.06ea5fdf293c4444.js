"use strict";(self.webpackChunkamacom=self.webpackChunkamacom||[]).push([[581],{1581:(X,g,a)=>{a.r(g),a.d(g,{InstitucionesModule:()=>R});var b=a(6814),r=a(6223),m=a(1896),S=a(9182),C=a(2589),h=a(9347),t=a(5879);let I=(()=>{class n{constructor(e,i){this.dialogRef=e,this.data=i}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(h.so),t.Y36(h.WI))};static#i=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-delete",5,"i"]],decls:26,vars:4,consts:[[1,"clearfix"],[1,"font-weight-bold"]],template:function(i,o){1&i&&(t.TgZ(0,"div")(1,"ul",0)(2,"li")(3,"p")(4,"span",1)(5,"strong"),t._uU(6,"Nombre: "),t.qZA()(),t._uU(7),t.qZA()(),t.TgZ(8,"li")(9,"p")(10,"span",1)(11,"strong"),t._uU(12,"Tipo: "),t.qZA()(),t._uU(13),t.qZA()(),t.TgZ(14,"li")(15,"p")(16,"span",1)(17,"strong"),t._uU(18,"Descripci\xf3n: "),t.qZA()(),t._uU(19),t.qZA()(),t.TgZ(20,"li")(21,"p")(22,"span",1)(23,"strong"),t._uU(24,"Fecha: "),t.qZA()(),t._uU(25),t.qZA()()()()),2&i&&(t.xp6(7),t.hij("",o.data.row.name," "),t.xp6(6),t.hij("",o.data.row.institutionTypeId," "),t.xp6(6),t.hij("",o.data.row.description," "),t.xp6(6),t.hij("",o.data.row.createdAt," "))}})}return n})();var s=a(553),v=a(9862),T=a(2939),Z=a(5798),U=a(4524);const x=function(){return{type:"img",resource:"assets/images/alarma.png"}};let F=(()=>{class n extends C.n{constructor(e,i,o,c,l){super(),this.httpClient=e,this.dialog=i,this.snackBar=o,this.router=c,this.pasoParametrosService=l,this.title="INSTITUCIONES",this.subtitle="En esta pantalla podr\xe1s visualizar las instituciones existentes",this.config={title:"Lista de instituciones",keys:["id","name","description","institutionTypeName","updatedAt"],headerColumns:["No","Nombre","Descripci\xf3n","Tipo","\xfaltima actualizaci\xf3n"],urlData:s.N.apiUrl+"/institution/consulta",typeColumns:["uuid",null,null,null,"date"],pageable:!0,showFilter:!0},this.modalForm={edit:{urlView:"/admin/instituciones/instituciones/add-institucion",actionType:"edit"},create:{urlView:"/admin/instituciones/instituciones/add-institucion",actionType:"add"},delete:{modal:{title:"Eliminar institucion",component:I},actionType:"delete",urlEndpoint:"/alarmSign"},view:{modal:{title:"Ver institucion",width:"400px",maxHeight:"500px"},actionType:"view",configView:[{label:"Nombre",key:"name"},{label:"Descripci\xf3n",key:"description"},{label:"Tipo",key:"institutionTypeName"},{label:"Fecha de creaci\xf3n",key:"createdAt",type:"date"},{label:"Fecha de actualizaci\xf3n",key:"updatedAt",type:"date"}]}}}addNew(){this.router.navigate(["/admin/instituciones/instituciones/add-institucion"])}search(e){this.pasoParametrosService.adicionarParametro("data",e),this.router.navigate(["/admin/instituciones/instituciones/search-institucion"])}editCall(e){this.pasoParametrosService.adicionarParametro("data",e),this.pasoParametrosService.adicionarParametro("modoEditar",!0),this.router.navigate(["/admin/instituciones/instituciones/add-institucion"])}deleteItem(e){let i;i="true"===localStorage.getItem("isRtl")?"rtl":"ltr",this.dialog.open(I,{data:e,direction:i})}loadData(){}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(v.eN),t.Y36(h.uw),t.Y36(T.ux),t.Y36(m.F0),t.Y36(Z.T))};static#i=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-allinstituciones"]],features:[t.qOj],decls:1,vars:7,consts:[[3,"title","subtitle","showCreateButton","configTable","modalForm","dialogIcon"]],template:function(i,o){1&i&&t._UZ(0,"app-crud-container",0),2&i&&t.Q6J("title",o.title)("subtitle",o.subtitle)("showCreateButton",!0)("configTable",o.config)("modalForm",o.modalForm)("dialogIcon",t.DdM(6,x))},dependencies:[U._]})}return n})();var A=a(7398),p=a(9397);let N=(()=>{class n{constructor(e,i){this.http=e,this.snackbar=i}save(e){return this.http.post(s.N.apiUrl+"/institution/create",e).pipe((0,p.b)(i=>{this.snackbar.open("Se cre\xf3 correctamente la institucion","Cerrar")}))}update(e){return this.http.put(s.N.apiUrl+"/institution",e).pipe((0,p.b)(i=>{this.snackbar.open("Se actualiz\xf3 correctamente","Cerrar")}))}guardarServiceInstituto(e){return this.http.post(s.N.apiUrl+"/institutionService/create",e).pipe((0,p.b)(i=>{this.snackbar.open("Se cre\xf3 correctamente el servicio","Cerrar")}))}updateServicioInstituto(e){return this.http.put(s.N.apiUrl+"/institutionService",e).pipe((0,p.b)(i=>{this.snackbar.open("Se actualiz\xf3 correctamente el servicio","Cerrar")}))}static#t=this.\u0275fac=function(i){return new(i||n)(t.LFG(v.eN),t.LFG(T.ux))};static#i=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var D=a(3221),Y=a(5295),k=a(9497),q=a(6877),y=a(2296),f=a(8034),E=a(3305),u=a(4170),J=a(617),P=a(2032),Q=a(2596);const _=["tableService"];function M(n,d){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," El nombre es requerido "),t.qZA())}function w(n,d){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," La descripci\xf3n es requerida "),t.qZA())}function G(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"form",9),t.NdJ("ngSubmit",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmit())}),t.TgZ(1,"div",0)(2,"div",10)(3,"mat-form-field",11)(4,"mat-label"),t._uU(5,"Nombre"),t.qZA(),t._UZ(6,"input",12),t.YNc(7,M,2,0,"mat-error",13),t.qZA()(),t.TgZ(8,"div",10),t._UZ(9,"app-mat-select-complete",14),t.qZA()(),t.TgZ(10,"div",0)(11,"div",15)(12,"mat-form-field",11)(13,"mat-label"),t._uU(14,"Descripci\xf3n"),t.qZA(),t._UZ(15,"textarea",16),t.YNc(16,w,2,0,"mat-error",13),t.qZA()()(),t.TgZ(17,"div",0)(18,"div",17)(19,"button",18),t._uU(20," Guardar y seguir "),t.qZA(),t.TgZ(21,"button",19),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.volver())}),t._uU(22," Cancelar "),t.qZA()()()()}if(2&n){const e=t.oxw();let i,o;t.Q6J("formGroup",e.institucionForm),t.xp6(7),t.Q6J("ngIf",null==(i=e.institucionForm.get("name"))?null:i.hasError("required")),t.xp6(2),t.Q6J("key","name")("keyValue","id")("value",e.valueInstitucion)("label","Tipo de instituci\xf3n")("control",e.institucionForm.controls.institutionTypeId)("options",e.listaTipoInstitucion),t.xp6(7),t.Q6J("ngIf",null==(o=e.institucionForm.get("description"))?null:o.hasError("required"))}}function z(n,d){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," El nombre es requerida "),t.qZA())}function V(n,d){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," La descripci\xf3n es requerida "),t.qZA())}function O(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"div",20)(1,"div",21)(2,"form",22)(3,"mat-form-field")(4,"mat-label"),t._uU(5,"Nombre"),t.qZA(),t._UZ(6,"input",23),t.YNc(7,z,2,0,"mat-error",13),t.qZA(),t.TgZ(8,"mat-form-field",24)(9,"mat-label"),t._uU(10,"Descripci\xf3n"),t.qZA(),t._UZ(11,"textarea",16),t.YNc(12,V,2,0,"mat-error",13),t.qZA(),t.TgZ(13,"div",0)(14,"div",25),t._UZ(15,"app-mat-select-complete",26),t.qZA(),t.TgZ(16,"div",27)(17,"mat-form-field",28)(18,"mat-label"),t._uU(19,"Efectividad inicial"),t.qZA(),t._UZ(20,"input",29),t.TgZ(21,"mat-hint"),t._uU(22,"DD/MM/YYYY"),t.qZA(),t._UZ(23,"mat-datepicker-toggle",30)(24,"mat-datepicker",null,31),t.qZA()(),t.TgZ(26,"div",27)(27,"mat-form-field",28)(28,"mat-label"),t._uU(29,"Efectividad final"),t.qZA(),t._UZ(30,"input",32),t.TgZ(31,"mat-hint"),t._uU(32,"DD/MM/YYYY"),t.qZA(),t._UZ(33,"mat-datepicker-toggle",30)(34,"mat-datepicker",null,33),t.qZA()()(),t.TgZ(36,"mat-action-row")(37,"button",34),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.guardarService())}),t._uU(38," Crear "),t.qZA()()(),t._UZ(39,"app-ng-table",35,36),t.qZA()()}if(2&n){const e=t.MAs(25),i=t.MAs(35),o=t.oxw();let c,l;t.xp6(2),t.Q6J("formGroup",o.serviceForm),t.xp6(5),t.Q6J("ngIf",null==(c=o.serviceForm.get("name"))?null:c.hasError("required")),t.xp6(5),t.Q6J("ngIf",null==(l=o.serviceForm.get("description"))?null:l.hasError("required")),t.xp6(3),t.Q6J("key","name")("keyValue","id")("label","Servicio")("control",o.serviceForm.controls.idServices)("options",o.listaServicios),t.xp6(5),t.Q6J("matDatepicker",e),t.xp6(3),t.Q6J("for",e),t.xp6(7),t.Q6J("matDatepicker",i),t.xp6(3),t.Q6J("for",i),t.xp6(6),t.Q6J("config",o.configTableServicio)}}const j=[{path:"all-instituciones",component:F,data:{breadcrumb:{title:"Todas las Instituciones"}}},{path:"add-institucion",component:(()=>{class n{setStep(e){this.step=e}nextStep(){this.step++}prevStep(){this.step--}constructor(e,i,o,c,l){this.fb=e,this.router=i,this.pasoParametrosService=o,this.http=c,this.institucionService=l,this.modoEditar=!1,this.listaSigAlarMadre=[],this.listaInstitucion=[],this.listaServicio=[],this.indicePrimerItem=1,this.indiceUltimoItem=10,this.checked=!1,this.step=0,this.isCreated=!1,this.configTableServicio={title:"Lista de servicios",keys:["id","name"],headerColumns:["No","Nombre"],urlData:s.N.apiUrl+"/institutionService/consulta",typeColumns:["uuid",null,null],pageable:!0,showFilter:!1,hideDefaultActions:{add:!0,view:!0,edit:!0,delete:!0},pageableOptions:{otherParams:{idInstitution:null}}},this.configTablePersona={title:"Lista de personas",keys:["id","name","description"],headerColumns:["No","Nombre","Descripci\xf3n"],urlData:s.N.apiUrl+"/institutionServicePerson/consulta",typeColumns:["uuid",null,null],pageable:!0,showFilter:!1,hideDefaultActions:{add:!0,view:!0,edit:!0,delete:!1}}}ngOnInit(){this.institucionForm=this.createContactForm(),this.serviceForm=this.fb.group({id:[null],idInstitution:[this.data?.id],idServices:[null,[r.kI.required]],name:[""],description:[""],effectivenessStart:[new Date],effectivenessEND:[""]}),this.getTipoInstitucion(this.institucionForm.value.institutionTypeId),this.configTableServicio.pageableOptions.otherParams={institutionId:this.data?.id}}onSubmit(){(this.modoEditar?this.institucionService.update(this.institucionForm.value):this.institucionService.save(this.institucionForm.value)).subscribe(i=>{this.isCreated=!0,this.configTableServicio.pageableOptions.otherParams={institutionId:i.id},this.configTablePersona.pageableOptions.otherParams={institutionId:i.id},this.data=i,this.serviceForm.controls.idInstitution.setValue(i.id)})}guardarService(){this.institucionService.guardarServiceInstituto(this.serviceForm.value).subscribe(e=>{this.tableService.findData()})}volver(){this.router.navigate(["/admin/instituciones/instituciones/all-instituciones"])}createContactForm(){return this.data=this.pasoParametrosService.obtenerParametro("data"),this.modoEditar=this.pasoParametrosService.obtenerParametro("modoEditar"),1==this.modoEditar?(this.titulo="Editar instituci\xf3n",this.subtitulo="En esta pantalla podr\xe1s editar la instituci\xf3n",this.isCreated=!0):(this.titulo="Adicionar instituci\xf3n",this.subtitulo="En esta pantalla podr\xe1s adicionar una instituci\xf3n"),this.fb.group({id:[this.data?.id],name:[this.data?.name,[r.kI.required]],description:[this.data?.description,[r.kI.required]],institutionTypeId:[this.data?.institutionTypeId,[r.kI.required]],createdAt:[this.data?.createdAt]})}listaTipoInstitucion(e){return this.http.get(s.N.apiUrl+"/typeInstitution/consulta",{params:{page:0,size:10,query:e}}).pipe((0,A.U)(o=>o?.content??[]))}getTipoInstitucion(e){e&&this.http.get(s.N.apiUrl+"/typeInstitution/"+e).subscribe(i=>{this.valueInstitucion=i})}listaServicios(e){return this.http.get(s.N.apiUrl+"/services/consulta",{params:{page:0,size:10,query:e}}).pipe((0,A.U)(i=>i?.content??[]))}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(r.QS),t.Y36(m.F0),t.Y36(Z.T),t.Y36(v.eN),t.Y36(N))};static#i=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-add-institucion"]],viewQuery:function(i,o){if(1&i&&t.Gf(_,5),2&i){let c;t.iGM(c=t.CRH())&&(o.tableService=c.first)}},decls:14,vars:3,consts:[[1,"row"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12"],[1,"card"],[1,"header"],["mat-mini-fab","","matTooltip","Volver",1,"btn","bg-purple","btn-lg","btn-block","waves-effect",3,"click"],[1,"body"],[3,"subtitle"],["stepperContent","","icon","apartment","label","Informacion basica"],["stepperContent","","label","Servicios","icon","design_services",3,"disabled"],[3,"formGroup","ngSubmit"],[1,"col-xl-6","col-lg-6","col-md-12","col-sm-12","mb-3"],["appearance","outline",1,"example-full-width","mb-3"],["matInput","","formControlName","name","required",""],[4,"ngIf"],["appearance","outline",3,"key","keyValue","value","label","control","options"],[1,"col-xl-12","col-lg-6","col-md-12","col-sm-12","mb-3"],["matInput","","formControlName","description","required",""],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mb-3"],["mat-raised-button","","color","primary",1,"btn-space"],["type","button","mat-raised-button","","color","warn",3,"click"],[1,"tableBody"],[1,"body","table-responsive"],[1,"row",3,"formGroup"],["matInput","","formControlName","name"],[1,"example-full-width","mb-3"],[1,"col-xl-4"],[3,"key","keyValue","label","control","options"],[1,"col-xl-4","col-lg-6","col-md-12","col-sm-12","mb-3"],["appearance","fill",1,"example-form-field"],["matInput","","formControlName","effectivenessStart",3,"matDatepicker"],["matIconSuffix","",3,"for"],["datepicker",""],["matInput","","formControlName","effectivenessEND",3,"matDatepicker"],["datepicker2",""],["mat-raised-button","","color","primary",3,"click"],[3,"config"],["tableService",""]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"a",4),t.NdJ("click",function(){return o.volver()}),t.TgZ(5,"mat-icon"),t._uU(6,"keyboard_return"),t.qZA()(),t.TgZ(7,"h3")(8,"strong"),t._uU(9),t.qZA()()(),t.TgZ(10,"div",5)(11,"app-mat-stepper-main",6),t.YNc(12,G,23,9,"ng-template",7),t.YNc(13,O,41,13,"ng-template",8),t.qZA()()()()()),2&i&&(t.xp6(9),t.hij(" ",o.titulo,""),t.xp6(2),t.Q6J("subtitle",o.subtitulo),t.xp6(2),t.Q6J("disabled",!o.isCreated))},dependencies:[b.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.sg,r.u,D.i,Y.r,k.f,q.X,y.lW,y.Tq,f.Mq,f.hl,f.nW,E.VG,u.KE,u.hX,u.bx,u.TO,u.R9,J.Hw,P.Nt,Q.gM]})}return n})(),data:{breadcrumb:{title:"Agregar Instituci\xf3n"}}},{path:"**",component:S.J}];let B=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#i=this.\u0275mod=t.oAB({type:n});static#e=this.\u0275inj=t.cJS({imports:[m.Bz.forChild(j),m.Bz]})}return n})();var L=a(7075),H=a(6208);let R=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#i=this.\u0275mod=t.oAB({type:n});static#e=this.\u0275inj=t.cJS({imports:[b.ez,B,r.u5,r.UX,L.K,H.m]})}return n})()}}]);