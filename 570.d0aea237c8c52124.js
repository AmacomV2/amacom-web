"use strict";(self.webpackChunkamacom=self.webpackChunkamacom||[]).push([[570],{1570:(y,Z,s)=>{s.r(Z),s.d(Z,{UsuarioModule:()=>et});var n=s(6814),i=s(6223),f=s(1896),U=s(2589),c=s(553),p=s(9347),t=s(5879);let A=(()=>{class e{constructor(r,a){this.dialogRef=r,this.data=a}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(p.so),t.Y36(p.WI))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-delete",5,"n"]],decls:19,vars:3,consts:[[1,"clearfix"],[1,"font-weight-bold"]],template:function(a,o){1&a&&(t.TgZ(0,"ul",0)(1,"li")(2,"p")(3,"span",1)(4,"strong"),t._uU(5,"Nombre de usuario: "),t.qZA()(),t._uU(6),t.qZA()(),t.TgZ(7,"li")(8,"p")(9,"span",1)(10,"strong"),t._uU(11,"Correo electr\xf3nico: "),t.qZA()(),t._uU(12),t.qZA()(),t.TgZ(13,"li")(14,"p")(15,"span",1)(16,"strong"),t._uU(17,"Rol: "),t.qZA()(),t._uU(18),t.qZA()()()),2&a&&(t.xp6(6),t.hij("",null==o.data?null:o.data.row.username," "),t.xp6(6),t.hij("",null==o.data?null:o.data.row.email," "),t.xp6(6),t.hij("",null==o.data?null:o.data.row.enumRol," "))}})}return e})();var h=s(9862),g=s(2939),v=s(5798),F=s(4524);let I=(()=>{class e extends U.n{constructor(r,a,o,l,d){super(),this.httpClient=r,this.dialog=a,this.snackBar=o,this.router=l,this.pasoParametrosService=d,this.title="Lista de usuarios",this.subtitle="En esta pantalla podr\xe1s visualizar los usuarios",this.config={title:"Lista de usuarios",headerColumns:["No","Nombre de usuario","Rol","Correo electr\xf3nico","\xfaltima actualizaci\xf3n"],keys:["id","username","enumRol","email","updatedAt"],urlData:c.N.apiUrl+"/users/consulta",typeColumns:["uuid",null,null,null,"date"],pageable:!0,showFilter:!0},this.modalForm={create:{urlView:"/admin/gestionar-usuarios/usuarios/add-usuario",actionType:"add"},edit:{urlView:"/admin/gestionar-usuarios/usuarios/add-usuario",actionType:"edit"},delete:{modal:{title:"Eliminar usuario",component:A},actionType:"delete",urlEndpoint:"/users"},view:{modal:{title:"Ver usuario",width:"400px",maxHeight:"500px"},actionType:"view",configView:[{label:"Nombre de usuario",key:"username"},{label:"Rol",key:"enumRol"},{label:"Correo electr\xf3nico",key:"email"},{label:"Fecha de creaci\xf3n",key:"createdAt",type:"date"},{label:"Fecha de actualizaci\xf3n",key:"updatedAt",type:"date"}]}},this.filterTable=[{label:"Nombre",placeholder:"Ingrese el nombre",key:"name"}]}ngOnInit(){this.llenarLista()}llenarLista(){}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(h.eN),t.Y36(p.uw),t.Y36(g.ux),t.Y36(f.F0),t.Y36(v.T))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-allusuarios"]],features:[t.qOj],decls:1,vars:6,consts:[[3,"title","subtitle","showCreateButton","configTable","modalForm","filterTable"]],template:function(a,o){1&a&&t._UZ(0,"app-crud-container",0),2&a&&t.Q6J("title",o.title)("subtitle",o.subtitle)("showCreateButton",!0)("configTable",o.config)("modalForm",o.modalForm)("filterTable",o.filterTable)},dependencies:[F._]})}return e})();var q=s(9182),N=s(7921),J=s(7398),m=s(4170),_=s(617),C=s(2032);function E(e,u){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," La contrase\xf1a es requerida "),t.qZA())}function x(e,u){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," La confirmaci\xf3n de la contrase\xf1a es requerida "),t.qZA())}let w=(()=>{class e{constructor(r,a){this.fb=r,this.dialog=a,this.fname="John",this.lname="Deo",this.hide=!0,this.chide=!0}ngOnInit(){this.addCusForm=this.fb.group({IdProof:null,firstname:[this.fname,[i.kI.required,i.kI.pattern("[a-zA-Z]+([a-zA-Z ]+)*")]],lastname:[this.lname,[i.kI.required,i.kI.pattern("[a-zA-Z]+([a-zA-Z ]+)*")]],email:[null,[i.kI.required,i.kI.email]],password:[null,[i.kI.required]],cpassword:[null,[i.kI.required]]})}closeDialog(){this.dialog.closeAll()}onSubmitClick(){console.log("Form Value",this.addCusForm?.value)}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(i.QS),t.Y36(p.uw))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-dialogform"]],decls:17,vars:7,consts:[[3,"formGroup","ngSubmit"],[1,"text-inside"],[1,"example-full-width"],["matInput","","formControlName","password","required","",3,"type"],["matSuffix","",1,"material-icons-two-tone","color-icon","p-3",3,"click"],[4,"ngIf"],["matInput","","formControlName","cpassword","required","",3,"type"]],template:function(a,o){1&a&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.onSubmitClick()}),t.TgZ(1,"div",1)(2,"mat-form-field",2)(3,"mat-label"),t._uU(4,"Contrase\xf1a"),t.qZA(),t._UZ(5,"input",3),t.TgZ(6,"mat-icon",4),t.NdJ("click",function(){return o.hide=!o.hide}),t._uU(7),t.qZA(),t.YNc(8,E,2,0,"mat-error",5),t.qZA()(),t.TgZ(9,"div",1)(10,"mat-form-field",2)(11,"mat-label"),t._uU(12,"Confirmar contrase\xf1a"),t.qZA(),t._UZ(13,"input",6),t.TgZ(14,"mat-icon",4),t.NdJ("click",function(){return o.chide=!o.chide}),t._uU(15),t.qZA(),t.YNc(16,x,2,0,"mat-error",5),t.qZA()()()),2&a&&(t.Q6J("formGroup",o.addCusForm),t.xp6(5),t.Q6J("type",o.hide?"password":"text"),t.xp6(2),t.hij(" ",o.hide?"visibility_off":"visibility",""),t.xp6(1),t.Q6J("ngIf",o.addCusForm.get("password").hasError("required")),t.xp6(5),t.Q6J("type",o.chide?"password":"text"),t.xp6(2),t.hij(" ",o.chide?"visibility_off":"visibility",""),t.xp6(1),t.Q6J("ngIf",o.addCusForm.get("cpassword").hasError("required")))},dependencies:[n.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,m.KE,m.hX,m.TO,m.R9,_.Hw,C.Nt]})}return e})();var Y=s(5739),P=s(1004);let T=(()=>{class e{constructor(r){this.http=r}createPerson(r){return this.http.post(c.N.apiUrl+"/users/newUser",r)}updatePerson(r){return this.http.put(c.N.apiUrl+"/users",r)}static#t=this.\u0275fac=function(a){return new(a||e)(t.LFG(h.eN))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var k=s(3848),D=s(4414),O=s(5295),Q=s(3680),S=s(2296),R=s(8525);function L(e,u){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," El nombre de usuario es requerido "),t.qZA())}function M(e,u){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," Por favor ingresar un correo electr\xf3nico v\xe1lido "),t.qZA())}function B(e,u){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," La contrase\xf1a es requerida "),t.qZA())}function j(e,u){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," La confirmaci\xf3n de la contrase\xf1a es requerida "),t.qZA())}function z(e,u){if(1&e){const r=t.EpF();t.TgZ(0,"div",10)(1,"div",23)(2,"mat-form-field",12)(3,"mat-label"),t._uU(4,"Contrase\xf1a"),t.qZA(),t._UZ(5,"input",24),t.TgZ(6,"mat-icon",25),t.NdJ("click",function(){t.CHM(r);const o=t.oxw();return t.KtG(o.hide=!o.hide)}),t._uU(7),t.qZA(),t.YNc(8,B,2,0,"mat-error",14),t.qZA()(),t.TgZ(9,"div",23)(10,"mat-form-field",12)(11,"mat-label"),t._uU(12,"Confirmar contrase\xf1a"),t.qZA(),t._UZ(13,"input",26),t.TgZ(14,"mat-icon",25),t.NdJ("click",function(){t.CHM(r);const o=t.oxw();return t.KtG(o.chide=!o.chide)}),t._uU(15),t.qZA(),t.YNc(16,j,2,0,"mat-error",14),t.qZA()()()}if(2&e){const r=t.oxw();t.xp6(5),t.Q6J("type",r.hide?"password":"text"),t.xp6(2),t.hij(" ",r.hide?"visibility_off":"visibility",""),t.xp6(1),t.Q6J("ngIf",r.usuarioForm.get("password").hasError("required")),t.xp6(5),t.Q6J("type",r.chide?"password":"text"),t.xp6(2),t.hij(" ",r.chide?"visibility_off":"visibility",""),t.xp6(1),t.Q6J("ngIf",r.usuarioForm.get("cpassword").hasError("required"))}}function G(e,u){if(1&e&&(t.TgZ(0,"mat-option",27),t._uU(1),t.qZA()),2&e){const r=u.$implicit;t.Q6J("value",r.id),t.xp6(1),t.hij(" ",r.name," ")}}function K(e,u){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," Selecciona un rol "),t.qZA())}function X(e,u){if(1&e){const r=t.EpF();t.TgZ(0,"div",10)(1,"div",28)(2,"button",29),t.NdJ("click",function(){t.CHM(r);const o=t.oxw();return t.KtG(o.openDialogChangePassword())}),t._uU(3," Cambiar contrase\xf1a "),t.TgZ(4,"mat-icon"),t._uU(5,"vpn_key"),t.qZA()()()()}}const H=function(){return["Usuarios"]},V=[{path:"all-usuarios",component:I},{path:"add-usuario",component:(()=>{class e{constructor(r,a,o,l,d,b,ot,rt,at){this.fb=r,this.dialog=a,this.router=o,this.pasoParametrosService=l,this.dialogModel=d,this.appDataService=b,this.http=ot,this.userCrudService=rt,this.authService=at,this.modoEditar=!1,this.hide3=!0,this.agree3=!1,this.hide=!0,this.chide=!0,this.getRoles=this.appDataService.getRoles(),this.valuePerson=null}ngOnInit(){this.usuarioForm=this.createContactForm(),this.data?.personId&&this.getPerson(this.data.personId).subscribe(r=>{this.valuePerson=r})}onSubmit(){(this.modoEditar?this.userCrudService.updatePerson(this.usuarioForm.value):this.userCrudService.createPerson(this.usuarioForm.value)).subscribe(a=>{this.cancelar()})}createContactForm(){return this.data=this.pasoParametrosService.obtenerParametro("data"),this.modoEditar=this.pasoParametrosService.obtenerParametro("modoEditar"),1==this.modoEditar?(this.titulo="Editar usuario",this.subtitulo="En esta pantalla podr\xe1s editar el usuario"):(this.titulo="Adicionar usuario",this.subtitulo="En esta pantalla podr\xe1s adicionar un usuario"),this.fb.group({id:[this.data?.id],username:[this.data?.username,[i.kI.required,i.kI.pattern("[a-zA-Z]+")]],idRol:[this.data?.idRol,[i.kI.required]],personId:[this.data?.personId,[i.kI.required]],password:[""],cpassword:["",i.kI.required],email:[this.data?.email,[i.kI.required,i.kI.email,i.kI.minLength(5)]]})}cancelar(){this.router.navigate(["/admin/gestionar-usuarios/usuarios/all-usuarios"])}openDialogChangePassword(){this.dialogModel.show({title:"Cambiar contrase\xf1a",component:w,width:"640px",actions:{primary:"Guardar",secondary:"Cancelar"}}).subscribe(r=>{r.estado&&this.authService.changePassword(r.data).subscribe(a=>{console.log(a),this.dialogModel.close()})})}searchPerson(r){return this.http.get(c.N.apiUrl+"/person/query",{params:{page:"0",size:"10",query:"%"+r+"%"}}).pipe((0,N.O)([this.data?.personId]),(0,J.U)(a=>a.content))}getPerson(r){return this.http.get(c.N.apiUrl+"/person/get?id="+r)}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(i.QS),t.Y36(p.uw),t.Y36(f.F0),t.Y36(v.T),t.Y36(Y.x),t.Y36(P.U),t.Y36(h.eN),t.Y36(T),t.Y36(k.e))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-add-usuario"]],decls:48,vars:24,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"row","clearfix"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12"],[1,"card"],[1,"header"],[1,"body"],[1,"m-4",3,"formGroup"],[1,"row"],[1,"col-xl-6","col-lg-6","col-md-12","col-sm-12","mb-3"],["appearance","outline",1,"example-full-width","mb-3"],["matInput","","formControlName","username","required",""],[4,"ngIf"],["matInput","","formControlName","email","required",""],["class","row",4,"ngIf"],["formControlName","idRol","required",""],[3,"value",4,"ngFor","ngForOf"],[3,"label","placeholder","clearButton","key","keyValue","value","control","options","appearance"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mb-3"],["mat-raised-button","","color","primary",1,"btn-space",3,"click"],["type","button","mat-raised-button","","color","warn",3,"click"],[1,"col-xl-6","col-lg-12","col-md-12","col-sm-12","mb-2"],["matInput","","formControlName","password","required","",3,"type"],["matSuffix","",1,"material-icons-two-tone","color-icon","p-3",3,"click"],["matInput","","formControlName","cpassword","required","",3,"type"],[3,"value"],[1,"col-xs-12","col-sm-6","col-md-3","col-lg-2"],["mat-raised-button","",1,"bg-green",3,"click"]],template:function(a,o){if(1&a&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2),t._UZ(3,"app-breadcrumb",3),t.qZA(),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"h3")(9,"strong"),t._uU(10),t.qZA()()(),t.TgZ(11,"div",7)(12,"h6"),t._uU(13),t.qZA()(),t.TgZ(14,"div",8)(15,"form",9)(16,"div",10)(17,"div",11)(18,"mat-form-field",12)(19,"mat-label"),t._uU(20,"Nombre de usuario"),t.qZA(),t._UZ(21,"input",13),t.YNc(22,L,2,0,"mat-error",14),t.qZA()(),t.TgZ(23,"div",11)(24,"mat-form-field",12)(25,"mat-label"),t._uU(26,"Correo electr\xf3nico"),t.qZA(),t._UZ(27,"input",15),t.YNc(28,M,2,0,"mat-error",14),t.qZA()()(),t.YNc(29,z,17,6,"div",16),t.TgZ(30,"div",10)(31,"div",11)(32,"mat-form-field",12)(33,"mat-label"),t._uU(34,"Rol"),t.qZA(),t.TgZ(35,"mat-select",17),t.YNc(36,G,2,2,"mat-option",18),t.ALo(37,"async"),t.qZA(),t.YNc(38,K,2,0,"mat-error",14),t.qZA()(),t.TgZ(39,"div",11),t._UZ(40,"app-mat-select-complete",19),t.qZA()(),t.YNc(41,X,6,0,"div",16),t.TgZ(42,"div",10)(43,"div",20)(44,"button",21),t.NdJ("click",function(){return o.onSubmit()}),t._uU(45," Guardar "),t.qZA(),t.TgZ(46,"button",22),t.NdJ("click",function(){return o.cancelar()}),t._uU(47," Cancelar "),t.qZA()()()()()()()()()()),2&a){let l,d,b;t.xp6(3),t.Q6J("title",o.titulo)("items",t.DdM(23,H))("active_item",o.titulo),t.xp6(7),t.hij(" ",o.titulo,""),t.xp6(3),t.Oqu(o.subtitulo),t.xp6(2),t.Q6J("formGroup",o.usuarioForm),t.xp6(7),t.Q6J("ngIf",null==(l=o.usuarioForm.get("username"))?null:l.hasError("required")),t.xp6(6),t.Q6J("ngIf",(null==(d=o.usuarioForm.get("email"))?null:d.hasError("email"))&&(null==(d=o.usuarioForm.get("email"))?null:d.touched)),t.xp6(1),t.Q6J("ngIf",!o.modoEditar),t.xp6(7),t.Q6J("ngForOf",t.lcZ(37,21,o.getRoles)),t.xp6(2),t.Q6J("ngIf",null==(b=o.usuarioForm.get("idRol"))?null:b.hasError("required")),t.xp6(2),t.Q6J("label","Persona")("placeholder","Buscar persona")("clearButton",!0)("key","fullName")("keyValue","id")("value",o.valuePerson)("control",o.usuarioForm.controls.personId)("options",o.searchPerson)("appearance","outline"),t.xp6(1),t.Q6J("ngIf",o.modoEditar)}},dependencies:[n.sg,n.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,D.L,O.r,Q.ey,S.lW,m.KE,m.hX,m.TO,m.R9,_.Hw,C.Nt,R.gD,n.Ov]})}return e})()},{path:"**",component:q.J}];let W=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({imports:[f.Bz.forChild(V),f.Bz]})}return e})();var $=s(3140),tt=s(6208);let et=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({providers:[T],imports:[n.ez,i.u5,i.UX,W,$.K,tt.m]})}return e})()},4414:(y,Z,s)=>{s.d(Z,{L:()=>p});var n=s(5879),i=s(6814),f=s(1896),U=s(9101);function c(t,A){if(1&t&&(n.TgZ(0,"li",9),n._uU(1),n.qZA()),2&t){const h=A.$implicit;n.xp6(1),n.Oqu(h)}}let p=(()=>{class t{constructor(){}static#t=this.\u0275fac=function(g){return new(g||t)};static#e=this.\u0275cmp=n.Xpm({type:t,selectors:[["app-breadcrumb"]],inputs:{title:"title",items:"items",active_item:"active_item"},decls:12,vars:4,consts:[[1,"row"],[1,"col-xs-12","col-sm-12","col-md-12","col-lg-12"],[1,"breadcrumb"],[1,"page-title"],[1,"breadcrumb-item","bcrumb-1"],[3,"routerLink"],["name","home",1,"breadcrumb-icon"],["class","breadcrumb-item",4,"ngFor","ngForOf"],[1,"breadcrumb-item","active"],[1,"breadcrumb-item"]],template:function(g,v){1&g&&(n.TgZ(0,"div",0)(1,"div",1)(2,"ul",2)(3,"li")(4,"h4",3),n._uU(5),n.qZA()(),n.TgZ(6,"li",4)(7,"a",5),n._UZ(8,"i-feather",6),n.qZA()(),n.YNc(9,c,2,1,"li",7),n.TgZ(10,"li",8),n._uU(11),n.qZA()()()()),2&g&&(n.xp6(5),n.Oqu(v.title),n.xp6(2),n.Q6J("routerLink","/admin/dashboard/main"),n.xp6(2),n.Q6J("ngForOf",v.items),n.xp6(2),n.Oqu(v.active_item))},dependencies:[i.sg,f.rH,U.u]})}return t})()}}]);