"use strict";(self.webpackChunkamacom=self.webpackChunkamacom||[]).push([[570],{1570:(y,Z,n)=>{n.r(Z),n.d(Z,{UsuarioModule:()=>et});var s=n(6814),r=n(6223),f=n(1896),U=n(2589),h=n(553),u=n(9347),t=n(5879),b=n(2296);let g=(()=>{class e{constructor(a,i){this.dialogRef=a,this.data=i}onNoClick(){this.dialogRef.close()}confirmDelete(){}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(u.so),t.Y36(u.WI))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-delete",5,"n"]],decls:34,vars:5,consts:[[1,"container"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"clearfix"],[1,"font-weight-bold"],["mat-dialog-actions","",1,"mb-1"],["mat-flat-button","","color","warn",3,"mat-dialog-close","click"],["mat-flat-button","","tabindex","-1",3,"click"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"\xbfEst\xe1 seguro de eliminar el usuario?"),t.qZA(),t.TgZ(3,"div",2)(4,"ul",3)(5,"li")(6,"p")(7,"span",4)(8,"strong"),t._uU(9,"Nombre de usuario: "),t.qZA()(),t._uU(10),t.qZA()(),t.TgZ(11,"li")(12,"p")(13,"span",4)(14,"strong"),t._uU(15,"Correo electr\xf3nico: "),t.qZA()(),t._uU(16),t.qZA()(),t.TgZ(17,"li")(18,"p")(19,"span",4)(20,"strong"),t._uU(21,"Rol: "),t.qZA()(),t._uU(22),t.qZA()(),t.TgZ(23,"li")(24,"p")(25,"span",4)(26,"strong"),t._uU(27,"Estado: "),t.qZA()(),t._uU(28),t.qZA()()()(),t.TgZ(29,"div",5)(30,"button",6),t.NdJ("click",function(){return o.confirmDelete()}),t._uU(31," Eliminar "),t.qZA(),t.TgZ(32,"button",7),t.NdJ("click",function(){return o.onNoClick()}),t._uU(33,"Cancelar"),t.qZA()()()),2&i&&(t.xp6(10),t.Oqu(o.data.nombreUsuario),t.xp6(6),t.Oqu(o.data.correo),t.xp6(6),t.hij("",o.data.rol," "),t.xp6(6),t.hij("",o.data.estado," "),t.xp6(2),t.Q6J("mat-dialog-close",1))},dependencies:[b.lW,u.ZT,u.uh,u.xY,u.H8]})}return e})();var c=n(9862),v=n(2939),A=n(5798),q=n(4524);let I=(()=>{class e extends U.n{constructor(a,i,o,l,p){super(),this.httpClient=a,this.dialog=i,this.snackBar=o,this.router=l,this.pasoParametrosService=p,this.title="Lista de usuarios",this.subtitle="En esta pantalla podr\xe1s visualizar los usuarios",this.config={title:"Lista de usuarios",headerColumns:["No","Nombre de usuario","Rol","Correo electr\xf3nico","\xfaltima actualizaci\xf3n"],keys:["id","username","enumRol","email","updatedAt"],urlData:h.N.apiUrl+"/users/consulta",typeColumns:["uuid",null,null,null,"date"],pageable:!0,showFilter:!0},this.modalForm={create:{urlView:"/admin/gestionar-usuarios/usuarios/add-usuario",actionType:"add"},edit:{urlView:"/admin/gestionar-usuarios/usuarios/add-usuario",actionType:"edit"},delete:{modal:{title:"Eliminar usuario",component:g},actionType:"delete",urlEndpoint:"/users"},view:{modal:{title:"Ver usuario",width:"400px",maxHeight:"500px"},actionType:"view",configView:[{label:"Nombre de usuario",key:"username"},{label:"Rol",key:"enumRol"},{label:"Correo electr\xf3nico",key:"email"},{label:"Fecha de creaci\xf3n",key:"createdAt",type:"date"},{label:"Fecha de actualizaci\xf3n",key:"updatedAt",type:"date"}]}},this.filterTable=[{label:"Nombre",placeholder:"Ingrese el nombre",key:"name"}]}ngOnInit(){this.llenarLista()}llenarLista(){}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(c.eN),t.Y36(u.uw),t.Y36(v.ux),t.Y36(f.F0),t.Y36(A.T))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-allusuarios"]],features:[t.qOj],decls:1,vars:6,consts:[[3,"title","subtitle","showCreateButton","configTable","modalForm","filterTable"]],template:function(i,o){1&i&&t._UZ(0,"app-crud-container",0),2&i&&t.Q6J("title",o.title)("subtitle",o.subtitle)("showCreateButton",!0)("configTable",o.config)("modalForm",o.modalForm)("filterTable",o.filterTable)},dependencies:[q._]})}return e})();var N=n(9182),J=n(7921),E=n(7398),d=n(4170),T=n(617),C=n(2032);function x(e,m){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," La contrase\xf1a es requerida "),t.qZA())}function k(e,m){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," La confirmaci\xf3n de la contrase\xf1a es requerida "),t.qZA())}let D=(()=>{class e{constructor(a,i){this.fb=a,this.dialog=i,this.fname="John",this.lname="Deo",this.hide=!0,this.chide=!0}ngOnInit(){this.addCusForm=this.fb.group({IdProof:null,firstname:[this.fname,[r.kI.required,r.kI.pattern("[a-zA-Z]+([a-zA-Z ]+)*")]],lastname:[this.lname,[r.kI.required,r.kI.pattern("[a-zA-Z]+([a-zA-Z ]+)*")]],email:[null,[r.kI.required,r.kI.email]],password:[null,[r.kI.required]],cpassword:[null,[r.kI.required]]})}closeDialog(){this.dialog.closeAll()}onSubmitClick(){console.log("Form Value",this.addCusForm?.value)}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(r.QS),t.Y36(u.uw))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-dialogform"]],decls:17,vars:7,consts:[[3,"formGroup","ngSubmit"],[1,"text-inside"],[1,"example-full-width"],["matInput","","formControlName","password","required","",3,"type"],["matSuffix","",1,"material-icons-two-tone","color-icon","p-3",3,"click"],[4,"ngIf"],["matInput","","formControlName","cpassword","required","",3,"type"]],template:function(i,o){1&i&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.onSubmitClick()}),t.TgZ(1,"div",1)(2,"mat-form-field",2)(3,"mat-label"),t._uU(4,"Contrase\xf1a"),t.qZA(),t._UZ(5,"input",3),t.TgZ(6,"mat-icon",4),t.NdJ("click",function(){return o.hide=!o.hide}),t._uU(7),t.qZA(),t.YNc(8,x,2,0,"mat-error",5),t.qZA()(),t.TgZ(9,"div",1)(10,"mat-form-field",2)(11,"mat-label"),t._uU(12,"Confirmar contrase\xf1a"),t.qZA(),t._UZ(13,"input",6),t.TgZ(14,"mat-icon",4),t.NdJ("click",function(){return o.chide=!o.chide}),t._uU(15),t.qZA(),t.YNc(16,k,2,0,"mat-error",5),t.qZA()()()),2&i&&(t.Q6J("formGroup",o.addCusForm),t.xp6(5),t.Q6J("type",o.hide?"password":"text"),t.xp6(2),t.hij(" ",o.hide?"visibility_off":"visibility",""),t.xp6(1),t.Q6J("ngIf",o.addCusForm.get("password").hasError("required")),t.xp6(5),t.Q6J("type",o.chide?"password":"text"),t.xp6(2),t.hij(" ",o.chide?"visibility_off":"visibility",""),t.xp6(1),t.Q6J("ngIf",o.addCusForm.get("cpassword").hasError("required")))},dependencies:[s.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.sg,r.u,d.KE,d.hX,d.TO,d.R9,T.Hw,C.Nt]})}return e})();var Y=n(5739),P=n(1004);let F=(()=>{class e{constructor(a){this.http=a}createPerson(a){return this.http.post(h.N.apiUrl+"/users/newUser",a)}updatePerson(a){return this.http.put(h.N.apiUrl+"/users",a)}static#t=this.\u0275fac=function(i){return new(i||e)(t.LFG(c.eN))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var w=n(3848),O=n(4414),Q=n(5295),S=n(3680),R=n(8525);function L(e,m){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," El nombre de usuario es requerido "),t.qZA())}function B(e,m){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," Por favor ingresar un correo electr\xf3nico v\xe1lido "),t.qZA())}function M(e,m){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," La contrase\xf1a es requerida "),t.qZA())}function j(e,m){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," La confirmaci\xf3n de la contrase\xf1a es requerida "),t.qZA())}function z(e,m){if(1&e){const a=t.EpF();t.TgZ(0,"div",10)(1,"div",23)(2,"mat-form-field",12)(3,"mat-label"),t._uU(4,"Contrase\xf1a"),t.qZA(),t._UZ(5,"input",24),t.TgZ(6,"mat-icon",25),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.hide=!o.hide)}),t._uU(7),t.qZA(),t.YNc(8,M,2,0,"mat-error",14),t.qZA()(),t.TgZ(9,"div",23)(10,"mat-form-field",12)(11,"mat-label"),t._uU(12,"Confirmar contrase\xf1a"),t.qZA(),t._UZ(13,"input",26),t.TgZ(14,"mat-icon",25),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.chide=!o.chide)}),t._uU(15),t.qZA(),t.YNc(16,j,2,0,"mat-error",14),t.qZA()()()}if(2&e){const a=t.oxw();t.xp6(5),t.Q6J("type",a.hide?"password":"text"),t.xp6(2),t.hij(" ",a.hide?"visibility_off":"visibility",""),t.xp6(1),t.Q6J("ngIf",a.usuarioForm.get("password").hasError("required")),t.xp6(5),t.Q6J("type",a.chide?"password":"text"),t.xp6(2),t.hij(" ",a.chide?"visibility_off":"visibility",""),t.xp6(1),t.Q6J("ngIf",a.usuarioForm.get("cpassword").hasError("required"))}}function G(e,m){if(1&e&&(t.TgZ(0,"mat-option",27),t._uU(1),t.qZA()),2&e){const a=m.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.name," ")}}function K(e,m){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," Selecciona un rol "),t.qZA())}function H(e,m){if(1&e){const a=t.EpF();t.TgZ(0,"div",10)(1,"div",28)(2,"button",29),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.openDialogChangePassword())}),t._uU(3," Cambiar contrase\xf1a "),t.TgZ(4,"mat-icon"),t._uU(5,"vpn_key"),t.qZA()()()()}}const W=function(){return["Usuarios"]},X=[{path:"all-usuarios",component:I},{path:"add-usuario",component:(()=>{class e{constructor(a,i,o,l,p,_,ot,at,it){this.fb=a,this.dialog=i,this.router=o,this.pasoParametrosService=l,this.dialogModel=p,this.appDataService=_,this.http=ot,this.userCrudService=at,this.authService=it,this.modoEditar=!1,this.hide3=!0,this.agree3=!1,this.hide=!0,this.chide=!0,this.getRoles=this.appDataService.getRoles(),this.valuePerson=null}ngOnInit(){this.usuarioForm=this.createContactForm(),this.data?.personId&&this.getPerson(this.data.personId).subscribe(a=>{this.valuePerson=a})}onSubmit(){(this.modoEditar?this.userCrudService.updatePerson(this.usuarioForm.value):this.userCrudService.createPerson(this.usuarioForm.value)).subscribe(i=>{this.cancelar()})}createContactForm(){return this.data=this.pasoParametrosService.obtenerParametro("data"),this.modoEditar=this.pasoParametrosService.obtenerParametro("modoEditar"),1==this.modoEditar?(this.titulo="Editar usuario",this.subtitulo="En esta pantalla podr\xe1s editar el usuario"):(this.titulo="Adicionar usuario",this.subtitulo="En esta pantalla podr\xe1s adicionar un usuario"),this.fb.group({id:[this.data?.id],username:[this.data?.username,[r.kI.required,r.kI.pattern("[a-zA-Z]+")]],idRol:[this.data?.idRol,[r.kI.required]],personId:[this.data?.personId,[r.kI.required]],password:[""],cpassword:["",r.kI.required],email:[this.data?.email,[r.kI.required,r.kI.email,r.kI.minLength(5)]]})}cancelar(){this.router.navigate(["/admin/gestionar-usuarios/usuarios/all-usuarios"])}openDialogChangePassword(){this.dialogModel.show({title:"Cambiar contrase\xf1a",component:D,width:"640px",actions:{primary:"Guardar",secondary:"Cancelar"}}).subscribe(a=>{a.estado&&this.authService.changePassword(a.data).subscribe(i=>{console.log(i),this.dialogModel.close()})})}searchPerson(a){return this.http.get(h.N.apiUrl+"/person/query",{params:{page:"0",size:"10",query:"%"+a+"%"}}).pipe((0,J.O)([this.data?.personId]),(0,E.U)(i=>i.content))}getPerson(a){return this.http.get(h.N.apiUrl+"/person/get?id="+a)}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(r.QS),t.Y36(u.uw),t.Y36(f.F0),t.Y36(A.T),t.Y36(Y.x),t.Y36(P.U),t.Y36(c.eN),t.Y36(F),t.Y36(w.e))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-add-usuario"]],decls:48,vars:24,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"row","clearfix"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12"],[1,"card"],[1,"header"],[1,"body"],[1,"m-4",3,"formGroup"],[1,"row"],[1,"col-xl-6","col-lg-6","col-md-12","col-sm-12","mb-3"],["appearance","outline",1,"example-full-width","mb-3"],["matInput","","formControlName","username","required",""],[4,"ngIf"],["matInput","","formControlName","email","required",""],["class","row",4,"ngIf"],["formControlName","idRol","required",""],[3,"value",4,"ngFor","ngForOf"],[3,"label","placeholder","clearButton","key","keyValue","value","control","options","appearance"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mb-3"],["mat-raised-button","","color","primary",1,"btn-space",3,"click"],["type","button","mat-raised-button","","color","warn",3,"click"],[1,"col-xl-6","col-lg-12","col-md-12","col-sm-12","mb-2"],["matInput","","formControlName","password","required","",3,"type"],["matSuffix","",1,"material-icons-two-tone","color-icon","p-3",3,"click"],["matInput","","formControlName","cpassword","required","",3,"type"],[3,"value"],[1,"col-xs-12","col-sm-6","col-md-3","col-lg-2"],["mat-raised-button","",1,"bg-green",3,"click"]],template:function(i,o){if(1&i&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2),t._UZ(3,"app-breadcrumb",3),t.qZA(),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"h3")(9,"strong"),t._uU(10),t.qZA()()(),t.TgZ(11,"div",7)(12,"h6"),t._uU(13),t.qZA()(),t.TgZ(14,"div",8)(15,"form",9)(16,"div",10)(17,"div",11)(18,"mat-form-field",12)(19,"mat-label"),t._uU(20,"Nombre de usuario"),t.qZA(),t._UZ(21,"input",13),t.YNc(22,L,2,0,"mat-error",14),t.qZA()(),t.TgZ(23,"div",11)(24,"mat-form-field",12)(25,"mat-label"),t._uU(26,"Correo electr\xf3nico"),t.qZA(),t._UZ(27,"input",15),t.YNc(28,B,2,0,"mat-error",14),t.qZA()()(),t.YNc(29,z,17,6,"div",16),t.TgZ(30,"div",10)(31,"div",11)(32,"mat-form-field",12)(33,"mat-label"),t._uU(34,"Rol"),t.qZA(),t.TgZ(35,"mat-select",17),t.YNc(36,G,2,2,"mat-option",18),t.ALo(37,"async"),t.qZA(),t.YNc(38,K,2,0,"mat-error",14),t.qZA()(),t.TgZ(39,"div",11),t._UZ(40,"app-mat-select-complete",19),t.qZA()(),t.YNc(41,H,6,0,"div",16),t.TgZ(42,"div",10)(43,"div",20)(44,"button",21),t.NdJ("click",function(){return o.onSubmit()}),t._uU(45," Guardar "),t.qZA(),t.TgZ(46,"button",22),t.NdJ("click",function(){return o.cancelar()}),t._uU(47," Cancelar "),t.qZA()()()()()()()()()()),2&i){let l,p,_;t.xp6(3),t.Q6J("title",o.titulo)("items",t.DdM(23,W))("active_item",o.titulo),t.xp6(7),t.hij(" ",o.titulo,""),t.xp6(3),t.Oqu(o.subtitulo),t.xp6(2),t.Q6J("formGroup",o.usuarioForm),t.xp6(7),t.Q6J("ngIf",null==(l=o.usuarioForm.get("username"))?null:l.hasError("required")),t.xp6(6),t.Q6J("ngIf",(null==(p=o.usuarioForm.get("email"))?null:p.hasError("email"))&&(null==(p=o.usuarioForm.get("email"))?null:p.touched)),t.xp6(1),t.Q6J("ngIf",!o.modoEditar),t.xp6(7),t.Q6J("ngForOf",t.lcZ(37,21,o.getRoles)),t.xp6(2),t.Q6J("ngIf",null==(_=o.usuarioForm.get("idRol"))?null:_.hasError("required")),t.xp6(2),t.Q6J("label","Persona")("placeholder","Buscar persona")("clearButton",!0)("key","fullName")("keyValue","id")("value",o.valuePerson)("control",o.usuarioForm.controls.personId)("options",o.searchPerson)("appearance","outline"),t.xp6(1),t.Q6J("ngIf",o.modoEditar)}},dependencies:[s.sg,s.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.sg,r.u,O.L,Q.r,S.ey,b.lW,d.KE,d.hX,d.TO,d.R9,T.Hw,C.Nt,R.gD,s.Ov]})}return e})()},{path:"**",component:N.J}];let V=(()=>{class e{static#t=this.\u0275fac=function(i){return new(i||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({imports:[f.Bz.forChild(X),f.Bz]})}return e})();var $=n(3140),tt=n(6208);let et=(()=>{class e{static#t=this.\u0275fac=function(i){return new(i||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({providers:[F],imports:[s.ez,r.u5,r.UX,V,$.K,tt.m]})}return e})()},4414:(y,Z,n)=>{n.d(Z,{L:()=>u});var s=n(5879),r=n(6814),f=n(1896),U=n(9101);function h(t,b){if(1&t&&(s.TgZ(0,"li",9),s._uU(1),s.qZA()),2&t){const g=b.$implicit;s.xp6(1),s.Oqu(g)}}let u=(()=>{class t{constructor(){}static#t=this.\u0275fac=function(c){return new(c||t)};static#e=this.\u0275cmp=s.Xpm({type:t,selectors:[["app-breadcrumb"]],inputs:{title:"title",items:"items",active_item:"active_item"},decls:12,vars:4,consts:[[1,"row"],[1,"col-xs-12","col-sm-12","col-md-12","col-lg-12"],[1,"breadcrumb"],[1,"page-title"],[1,"breadcrumb-item","bcrumb-1"],[3,"routerLink"],["name","home",1,"breadcrumb-icon"],["class","breadcrumb-item",4,"ngFor","ngForOf"],[1,"breadcrumb-item","active"],[1,"breadcrumb-item"]],template:function(c,v){1&c&&(s.TgZ(0,"div",0)(1,"div",1)(2,"ul",2)(3,"li")(4,"h4",3),s._uU(5),s.qZA()(),s.TgZ(6,"li",4)(7,"a",5),s._UZ(8,"i-feather",6),s.qZA()(),s.YNc(9,h,2,1,"li",7),s.TgZ(10,"li",8),s._uU(11),s.qZA()()()()),2&c&&(s.xp6(5),s.Oqu(v.title),s.xp6(2),s.Q6J("routerLink","/admin/dashboard/main"),s.xp6(2),s.Q6J("ngForOf",v.items),s.xp6(2),s.Oqu(v.active_item))},dependencies:[r.sg,f.rH,U.u]})}return t})()}}]);